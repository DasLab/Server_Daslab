{% extends "media/html/_internal.html" %}
{% block content %}
<div class="starter-template">
	<div class="container">
		<div class="row">
			<div class="col-md-2">
				<div class="panel panel-default" id="sidebar">
					<div class="panel-heading">
						<h2 class="panel-title"><span class="glyphicon glyphicon-th-list" aria-hidden="true"></span>&nbsp;&nbsp;Sections</h2>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-md-12">
								<ul class="nav" role="tablist" id="scroll_nav">
									<li class="li-primary">
										<a id="tab_1" href="#aws">
											<span class="glyphicon glyphicon-text-background"></span><b>&nbsp;&nbsp;Amazon Web Services</b>
										</a>
									</li>
									<li class="li-magenta">
										<a id="tab_2" href="#ga">
											<span class="glyphicon glyphicon-signal"></span><b>&nbsp;&nbsp;Google Analytics</b>
										</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="col-md-10" id="main">

				<div class="panel panel-primary" id="aws">
					<div class="panel-heading">
						<h2 class="panel-title"><span class="glyphicon glyphicon-text-background" aria-hidden="true"></span>&nbsp;&nbsp;Amazon Web Services</h2>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-md-12">
								<h3><span class="label label-default">Overview</span></h3>
								<table class="table">
									<thead>
										<tr class="active">
											<th class="col-md-4">EC2: Elastic Compute Cloud</th>
											<th class="col-md-4">ELB: Elastic Load Balancing</th>
											<th class="col-md-4">EBS: Elastic Bloack Store</th>
										</tr>
									</thead>
									<tbody>
										{% for val in aws.table %}
											<tr>
												<td>
													{% if val.ec2.status == 0 %}
														<span class="pull-left"><span class="label label-warning"><span class="glyphicon glyphicon-question-sign"></span></span></span>
													{% elif val.ec2.status == 16 %}
														<span class="pull-left"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
													{% elif val.ec2.status == 48 or val.ec2.status == 80 %}
														<span class="pull-left"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
													{% elif val.ec2.status == 32 or val.ec2.status == 64 %}
														<span class="pull-left"><span class="label label-magenta"><span class="glyphicon glyphicon-exclamation-sign"></span></span></span>
													{% endif %}
													&nbsp;&nbsp;
													<span class="label label-orange">{{val.ec2.id}}</span>
													&nbsp;&nbsp;
													<u><a href="#ec2-{{val.ec2.name}}" id="aws_ec2-{{val.ec2.name}}">{{val.ec2.name}}</a></u>
												</td>
												<td>
													{% if val.elb.status %}
														<span class="pull-left"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
													{% elif val.elb.name %}
														<span class="pull-left"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
													{% endif %}
													&nbsp;&nbsp;
													<u><a href="#elb-{{val.elb.name}}" id="aws_elb-{{val.elb.name}}">{{val.elb.name}}</a></u>
												</td>
												<td>
													{% if val.ebs.status == 'in-use' %}
														<span class="pull-left"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
													{% elif val.ebs.name %}
														<span class="pull-left"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
													{% endif %}
													&nbsp;&nbsp;
													<span class="label label-orange">{{val.ebs.id}}</span>
													&nbsp;&nbsp;
													<u><a href="#ebs-{{val.ebs.name}}" id="aws_ebs-{{val.ebs.name}}">{{val.ebs.name}}</a></u>
												</td>
											</tr>
										{% endfor %}
										<tr><td colspan="3"></td></tr>
									</tbody>
								</table>
							</div>
						</div>

						<div class="row">
							<div class="col-md-12">
								<h3><span class="label label-dark-red">EC2: Elastic Compute Cloud</span></h3>
								<div class="thumbnail" style="padding:20px 40px;">
								{% for ec2 in aws.ec2 %}
									<div class="row" id="ec2-{{ec2.name}}">
										<div class="col-md-9">
											<p>
											{% if ec2.status == 0 %}
												<span class="pull-left lead"><span class="label label-warning"><span class="glyphicon glyphicon-question-sign"></span></span></span>
											{% elif ec2.status == 16 %}
												<span class="pull-left lead"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
											{% elif ec2.status == 48 or ec2.status == 80 %}
												<span class="pull-left lead"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
											{% elif ec2.status == 32 or ec2.status == 64 %}
												<span class="pull-left lead"><span class="label label-magenta"><span class="glyphicon glyphicon-exclamation-sign"></span></span></span>
											{% endif %}
												&nbsp;&nbsp;<span class="lead"><b><u>{{ec2.name}}</u></b></span>&nbsp;&nbsp;
												<span class="label label-orange">{{ec2.id}}</span>
												<span class="label label-primary">{{ec2.type}}</span>
												<span class="label label-info">{{ec2.arch}}</span>
												<span class="label label-violet">{{ec2.region}}</span>
											</p>
											<p><a href="http://{{ec2.dns}}" target="_blank"><code>{{ec2.dns}}</code></a></p>
										</div>
										<div class="col-md-3">
											<p class="text-right"><span class="label label-inverse">Credits Balance</span></p>
											<p class="text-right"><i><mark>{{ec2.credit}}</mark></i></p>
										</div>
									</div>
									<div class="row">
										<div class="col-md-6">
											<div id="plot_cpu_{{ec2.id}}" class="thumbnail place_holder" style="padding:0px 20px; height: 120px;"></div>
										</div>
										<div class="col-md-6">
											<div id="plot_net_{{ec2.id}}" class="thumbnail place_holder" style="padding:0px 20px; height: 120px;"></div>
										</div>
									</div>
									{% if forloop.revcounter0 %}<hr/ style="margin: 10px;">{% endif %}
								{% endfor %}
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col-md-12">
								<h3><span class="label label-teal">ELB: Elastic Load Balancing</span></h3>
								<div class="thumbnail" style="padding:20px 40px;">
								{% for elb in aws.elb %}
									<div class="row" id="elb-{{elb.name}}">
										<p>
										{% if elb.status %}
											<span class="pull-left lead"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
										{% else %}
											<span class="pull-left lead"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
										{% endif %}
											&nbsp;&nbsp;<span class="lead"><b><u>{{elb.name}}</u></b></span>&nbsp;&nbsp;
											<span class="label label-violet">{{elb.region}}</span>
										</p>
										<p>
											<a href="http://{{elb.dns}}" target="_blank"><code>{{elb.dns}}</code></a>
										</p>
									</div>
									<div class="row">
										<div class="col-md-6">
											<div id="plot_lat_{{elb.name}}" class="thumbnail place_holder" style="padding:0px 20px; height: 120px;"></div>
										</div>
										<div class="col-md-6">
											<div id="plot_req_{{elb.name}}" class="thumbnail place_holder" style="padding:0px 20px; height: 120px;"></div>
										</div>
									</div>
									{% if forloop.revcounter0 %}<hr/ style="margin: 10px;">{% endif %}
								{% endfor %}
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col-md-12">
								<h3><span class="label label-dark-blue">EBS: Elastic Block Store</span></h3>
								<div class="thumbnail" style="padding:20px 40px;">
								{% for ebs in aws.ebs %}
									<div class="row" id="ebs-{{ebs.name}}">
										<div class="col-md-4">
											<p>
											{% if ebs.status == 'in-use' %}
												<span class="pull-left lead"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
											{% else %}
												<span class="pull-left lead"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
											{% endif %}
												&nbsp;&nbsp;<span class="lead"><b><u>{{ebs.name}}</u></b></span>&nbsp;&nbsp;
											</p>
											<p>
												<span class="label label-orange">{{ebs.id}}</span>
												<span class="label label-primary">{{ebs.type}}</span>
												<span class="label label-info">{{ebs.size}} GB</span>
												<span class="label label-violet">{{ebs.region}}</span>
												{% if ebs.encrypted %}<span class="label label-warning">Encrypted</span>{% endif %}
											</p>
										</div>
										<div class="col-md-8">
											<div id="plot_disk_{{ebs.id}}" class="thumbnail place_holder" style="padding:0px 20px; height: 120px;"></div>
										</div>
									</div>
									{% if forloop.revcounter0 %}<hr/ style="margin: 10px;">{% endif %}
								{% endfor %}
								</div>
							</div>
						</div>

					</div>
				</div>
				
				<div class="panel panel-magenta" id="ga">
					<div class="panel-heading">
						<h2 class="panel-title"><span class="glyphicon glyphicon-signal" aria-hidden="true"></span>&nbsp;&nbsp;Google Analytics</h2>
					</div>
					<div class="panel-body">
						<div id="embed-api-auth-container"></div>
						<div id="view-selector-container"></div>

						<div class="row">
							<div class="col-md-12">
								<div class="thumbnail" style="padding:20px 40px;">
								{% for proj in ga.projs %}
									<div class="row" id="elb-{{name}}">
										<p>
										{% if proj.name %}
											<span class="pull-left lead"><span class="label label-green"><span class="glyphicon glyphicon-ok-sign"></span></span></span>
										{% else %}
											<span class="pull-left lead"><span class="label label-danger"><span class="glyphicon glyphicon-remove-sign"></span></span></span>
										{% endif %}
											&nbsp;&nbsp;<span class="lead"><b><u>{{proj.name}}</u></b></span>&nbsp;&nbsp;
											<span class="label label-primary">{{proj.track_id}}</span>
											<span class="pull-right">
												<span class="label label-warning">Bounce Rate</span>
												<span class="text-right" style="margin-bottom:0px;">{{proj.bounceRate}} %</span>
												<span class="label label-orange">Users</span>
												<span class="text-right" style="margin-bottom:0px;">{{proj.users}}</span>
											</span>
										</p>
										<p>
											<a href="{{proj.url}}" target="_blank"><code>{{proj.url}}</code></a>
											<span class="pull-right">
												<span class="label label-success">Sessions</span>
												<span class="text-right" style="margin-bottom:0px;">{{proj.sessions}}</span>
												<span class="label label-success">Session Duration</span>
												<span class="text-right" style="margin-bottom:0px;">{{proj.sessionDuration}}</span>
												<span class="label label-info">Page Views</span>
												<span class="text-right" style="margin-bottom:0px;">{{proj.pageviews}}</span>
												<span class="label label-info">Page View / Session</span>
												<span class="text-right" style="margin-bottom:0px;">{{proj.pageviewsPerSession}}</span>
											</span>
										</p>
									</div>
									<div class="row">
										<div class="col-md-6">
											<div id="chart_session_{{proj.id}}" class="thumbnail place_holder" style="padding:0px 20px;"></div>
										</div>
										<div class="col-md-6">
											<div id="chart_visitor_{{proj.id}}" class="thumbnail place_holder" style="padding:0px 20px;"></div>
										</div>
									</div>
									{% if forloop.revcounter0 %}<hr/ style="margin: 10px;">{% endif %}
								{% endfor %}
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>
</div>
{% endblock %}


{% block script %}
	<script type="text/javascript">
		$(document).ready(function() {
			$('.dropdown-toggle').removeClass("active");
			$("#nav_servers").addClass("active");
	    	$("#nav_logo").css("text-decoration","none");

		    $("#sidebar").attr("data-spy","affix").affix( { offset: { top: $("#main").position().top} } );
	    	$("#sidebar").css("width", $("#sidebar").width());
	    	$("#sidebar").css("margin", 0);

	    	$("[id^=tab_]").on('click', function () {
				$('html, body').stop().animate({scrollTop: $("#jumbotron").offset().top - 75}, 500);
				$("#main").find(".panel").not(".subpanel").not(".month").hide();
				$($(this).attr("href")).show();
	    	});
			$('#top').on('click', function () {
				$('html, body').stop().animate({scrollTop: $("#main").offset().top - 75}, 500);
			});
	    	$("[id^=aws_]").on('click', function () {
			    $('html, body').stop().animate({scrollTop: $($(this).attr("href")).offset().top - 75}, 500);
	    	});
		});
	</script>
    <script type="text/javascript" src="http://www.google.com/jsapi" ></script>
	<script type="text/javascript" src="/site_media/js/group/aws.js"></script>
	<script type="text/javascript" src="/site_media/js/group/ga.js"></script>
	<script type="text/javascript">
		{% for ec2 in aws.ec2 %}
			drawEC2("{{ec2.id}}");
		{% endfor %}
		{% for elb in aws.elb %}
			drawELB("{{elb.name}}");
		{% endfor %}
		{% for ebs in aws.ebs %}
			drawEBS("{{ebs.id}}");
		{% endfor %}
	</script>
	<script type="text/javascript">
		gapi.analytics.ready(function() {
			gapi.analytics.auth.authorize({
				'container': 'embed-api-auth-container',
				'clientid': '{{ga.client_id}}',
				'serverAuth': { 'access_token': '{{ga.access_token}}' }
			});

			new gapi.analytics.ViewSelector({ 'container': 'view-selector-container' }).execute();

			{% for proj in ga.projs %}
				drawSVG('{{proj.id}}');
			{% endfor %}
		});
	</script>

{% endblock %}

